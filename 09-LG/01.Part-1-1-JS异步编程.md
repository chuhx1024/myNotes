## 关于 Promise

- 基本使用
```js
const promise = new Promise((resolve, reject) => {
  resolve(100)
  reject(new Error('失败了'))
})
// 第二个参数 只等捕获本次的异常 如果在第一个参数总有异常就捕获不到了
promise.then(val => {
  console.log(val, 123)
}, val => {
  console.log(val, 888)
})
// 此方法 相当于给 整个链式链条捕获异常  如果在第一个参数总有异常就能捕获到
// 因为 Promise 的异常一直会向后传递 直至被捕获
// 所以第二种更常用
promise.then(val => {
  console.log(val)
}).catch(val => {
  console.log(val, 888)
})

promise.then(undefined, val => {
  console.log('失败了')
  console.log(val)
})
primise.catch(val => {
  console.log('失败了')
  console.log(val)
})
```
- 如何让 promise 异常 走 catch 方法
  - new Promise 时 添加 new Error
```js
const promise0 = new Promise((resolve, reject) => {
  resolve(new Error('失败了'))
})

const promise1 = new Promise((resolve, reject) => {
  reject(new Error('失败了'))
})
```
  - new Promise 时  在 resolve() 前 调用了没有定义的 方法
```js
const promise2 = new Promise((resolve, reject) => {
  foo()
  resolve(100)
  reject(new Error('失败了'))
})
```

  - 封装的 ajax 调用时请求错误

- 给全局注册一个事件  捕获没有被捕获的异常
```js
process.on('unhandleRejection', (reason, promise) => {
  console.log(reason)  // 失败原因 一般是一个对象
  console.log(promise) // 出现异常的 Promise 对象
})
```




